<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="generator" content="ReText 4.0.0">
<title>geo</title>
</head>
<body>
<table ><tr>
<td>

<div id="sidebar"> <!-- Sidebar -->

<div id="linkpool" > <!-- Links to main pages, id=linkpool-->
<table><tbody><tr><td>
<div><h3><a style="text-decoration: none;color:#880000" href="#doc">Main pages</a></h3></div>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="./install.html">Install</a><br><br>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="./configuration.html">Configuration</a><br><br>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="./restful-search.html">RESTful API : Search</a><br><br>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="./restful-insert-update-delete.html">RESTful API : Insert/Update/Delete</a><br><br>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="./restful-control.html">RESTful API : Control</a><br><br>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="./geo.html">Geo Search</a></br><br>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="./ranking.html">Ranking</a></br><br>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="./mongodb.html">MongoDB Search</a></br><br>
</td></tr></tbody></table>
<span ><a href="http://www.srch2.com" target="_blankt"><img style="width:100px" src="images/logo.png" /></a></span></br></br>
</div> <!-- Links to main pages, id=linkpool-->
<hr/>

<div id="content" > <!-- Table of content, id=content-->
<table><tbody><tr><td>
<div>
<h3>
<a style="text-decoration: none;color:#880000" href="#doc">Content</a></h3></div>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="#geo-engine-config">Geo Engine Configuration</a></br><br>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="#geo-query-syntax">Geo Query Syntax</a></br><br>
&nbsp;&nbsp;&nbsp;<a style="text-decoration: none;color:#3366FF" href="#geo-query-ranking">Geo Query Ranking</a></br><br>
</td></tr></tbody></table>

</div> <!-- Table of content, id=content-->
</div> <!-- Sidebar -->

</td>

<td style="width:75%">
</br>
<div><table><tbody><tr><td>
<div><h3><a style="text-decoration: none;color:#880000" href="#doc"></a></h3></div>

</td></tr></tbody></table>

</div>

<h1 id="doc" style="color:#880000"><center>SRCH2 Documentation: Geo Search</center></h1>
<h6 id="versionInfo" style="font-size: 12px; margin-top: -20px;"><center>Version: 4.0.0, Date: September 19, 2013</center></h6>
<p>This documentation discusses how to use the SRCH2 engine to do powerful geo search (location-based search). The engine can index records with location information specified as a latitude and a longitude, and do search based on both keywords and locations. For example, we can use the engine to find stores called "ghirardelli" within two miles to a location in San Francisco. The engine provides all the features such as instant search and fuzzy search, making it easy to develop an application to provide great user experiences.</p>
<h3 id="geo-engine-config">1. Geo Engine Configuration</h3>
<p>The engine has two indexing options:</p>
<ul>
<li>
<p>Option 1: Keyword Search;</p>
</li>
<li>
<p>Option 2: Keyword + Geo Search, which can do location-based search.</p>
</li>
</ul>
<p>We need to choose one option before starting the engine, since the engine will index the data differently depending on the option.</p>
<p>To use geo indexing, use the following parameter in the configuration:</p>
<pre><code>&lt;indexType&gt;1&lt;/indexType&gt;
</code></pre>

<p>The value "1" means that the indexing type is for geo. Correspondingly, we need to have two fields with the type "location_latitude" and "location_longitude", respectively. For example:</p>
<pre><code>&lt;field name=&quot;lat&quot; default=&quot;0&quot; required=&quot;true&quot; type=&quot;location_latitude&quot;/&gt;
&lt;field name=&quot;lng&quot; default=&quot;0&quot; required=&quot;true&quot; type=&quot;location_longitude&quot;/&gt;
</code></pre>

<p>Each record should have two values for these two types, and they should be float numbers. For example:</p>
<pre><code>{&quot;id&quot; : &quot;1234&quot;, &quot;name&quot; : &quot;Toy Story&quot;, &quot;category&quot; : &quot;shop&quot;, &quot;lat&quot; : 43.22, &quot;lng&quot;: -80.22}
</code></pre>

<h3 id="geo-query-syntax">2. Geo Query Syntax</h3>
<p>If geo indexing is used, a geo query should use one of the following two ways to define a geo region to search on:</p>
<ul>
<li>Specify a bounding box:</li>
</ul>
<blockquote>
<ul>
<li>
<p>"lblat": the latitude of the left-bottom point of the bounding box;</p>
</li>
<li>
<p>"lblong": the longitude of the left-bottom point of the bounding box;</p>
</li>
<li>
<p>"rtlat": the latitude of the top-right point of the bounding box;</p>
</li>
<li>
<p>"rtlong": the longitude of the top-right point of the bounding box.</p>
</li>
</ul>
</blockquote>
<ul>
<li>Specify a center point and a radius:</li>
</ul>
<blockquote>
<ul>
<li>
<p>"clat": the latitude of the center point;</p>
</li>
<li>
<p>"clong": the longitude of the center point;</p>
</li>
<li>
<p>"radius": the radius of the search range in degree.</p>
</li>
</ul>
</blockquote>
<p>The following is an example geo query:</p>
<pre><code>$ curl -i &quot;http://localhost:8081/search?q=girardelli&amp;start=0&amp;rows=20&amp;lblat=61.20&amp;lblong=-149.90&amp;rtlat=61.22&amp;rtlong=-149.70&quot;
</code></pre>

<h3 id="geo-query-ranking">3. Geo Query Ranking</h3>
<p>The engine ranks each result using a score that combines its textual similarity with the query keywords and its geo distance to the location specified in the query.</p>
<p><hr/>
Have fun SRCHing!</p>
<style type="text/css">
#sidebar{
position:fixed;
width:20%;
left:10px;
top:20px;
padding: 5.5px;
font-size: 13px;
//line-height: 20px;
word-break: break-all;
word-wrap: break-word;
white-space: pre;
white-space: pre-wrap;
background-color: #f5f5f5;
border: 1px solid #ccc;
border: 1px solid rgba(0, 0, 0, 0.15);
-webkit-border-radius: 4px;
-moz-border-radius: 4px;
border-radius: 4px;
text-align:center;
}
pre{
margin: auto;
width:80%;
display: block;
padding: 9.5px;
font-size: 13px;
line-height: 20px;
word-break: break-all;
word-wrap: break-word;
white-space: pre;
white-space: pre-wrap;
background-color: #f5f5f5;
border: 1px solid #ccc;
border: 1px solid rgba(0, 0, 0, 0.15);
-webkit-border-radius: 4px;
-moz-border-radius: 4px;
border-radius: 4px;
overflow:auto;
max-height:600px;
}

html{
min-width:1100px;
}
#indexTable{
padding: 5.5px;
font-size: 13px;
//line-height: 20px;
word-break: break-all;
word-wrap: break-word;
white-space: pre;
white-space: pre-wrap;
background-color: #f5f5f5;
border: 1px solid #ccc;
border: 1px solid rgba(0, 0, 0, 0.15);
-webkit-border-radius: 4px;
-moz-border-radius: 4px;
border-radius: 4px;
text-align:center;
display: inline-block
}
#bigBox{
padding: 10px;
font-size: 13px;
white-space: pre;
white-space: pre-wrap;
background-color: #f5f5f5;
border: 1px solid #ccc;
border: 1px solid rgba(0, 0, 0, 0.15);
-webkit-border-radius: 4px;
-moz-border-radius: 4px;
border-radius: 4px;
//text-align:center;
display: inline-block
}

</style>

<script>
function alertSize() {
var myWidth = 0, myHeight = 0;
if( typeof( window.innerWidth ) == 'number' ) {
//Non-IE
myWidth = window.innerWidth;
myHeight = window.innerHeight;
} else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
//IE 6+ in 'standards compliant mode'
myWidth = document.documentElement.clientWidth;
myHeight = document.documentElement.clientHeight;
} else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
//IE 4 compatible
myWidth = document.body.clientWidth;
myHeight = document.body.clientHeight;
}
//window.alert( 'Width = ' + myWidth );
//window.alert( 'Height = ' + myHeight );
var linkpoolHeight = document.getElementById('linkpool').clientHeight;
document.getElementById('content').setAttribute('style' , 'height:'+(myHeight-linkpoolHeight-100)+'px;overflow:auto');
}
alertSize();
</script>
</body>
</html>
