
# Srch2: configuration file for the search server
#
# Please contact support@srch2.com if you have questions.

####################### Parameters on local filesystem ###############

# License key file. Make sure to set the path to the srch2 license key
# file provided with the package.
# REQUIRED.
license-file=../../conf/srch2_license_key.txt

# Flag to indicate whether we want to create indexes from a data file
# or load them from existing serialized files.
# 0 - Create the indexes from a data file;
# 1 - Load indexes from existing serialized files.
# OPTIONAL. Defaults to 0
index-load-or-create=0

# Path for a data file to be loaded. The file must be in the json format.
# REQUIRED, when "index-load-or-create" is set to 0.
data-file-path=data.json
 
# The file path to the folder where we store serialized index files.
# REQUIRED, when "index-load-or-create" is set to 1.
index-dir-path=./

# Path to the log file.  Notice that the time in the log file is UTC time.
# REQUIRED.
access-log-file=./log.txt

# Primary key attribute of the data
# REQUIRED
primary-key=id

# Flag to indicate whether the primary key is searchable.
# 0 - NO
# 1 - YES
# OPTIONAL. Default value is 0
is-primary-key-searchable=0	

# Attributes we want to search on in addition to the primary key. Specify them
# as comma separated entries, e.g., title,name,address,affiliation.
# REQUIRED
attributes-search=category,name


# default values for searchable attributes which are defined in attributes-search
# OPTIONAL : default is "" for each value
attributes-search-default=IGNORE

# Is each searchable attribute required
# OPTIONAL : default : false
attributes-search-required=IGNORE

# Attributes that can be used for post processing filters and facets
# OPTIONAL
non-searchable-attributes=IGNORE

# Types of the non-searchable attribute. A type can be int, float, text or time.
# If non-searchable-attributes is set this option is REQUIRED.
non-searchable-attributes-types=IGNORE

# Default values for non-searchable-attributes
# If non-searchable-attributes is set this option is REQUIRED.
non-searchable-attributes-default=IGNORE

# Is each non-searchable-attribute required
# OPTOINAL : default is false
non-searchable-attributes-required=IGNORE

######################### Faceted search ############################
# is faceted search enabled
# OPTIONAL : default is false
facet-enable=IGNORE

# Attributes which are used to create facets. This attributes must also be declared in non-searchable-attributes
# if facet-enable is true REQUIRED
facet-attributes=IGNORE

# Facet type for each attribute. 0 for Categorical and 1 for Range facet.
# if facet-enable is true REQUIRED
facet-attribute-type=IGNORE

# Start of range facets. Insert empty string for Categorical facets.
# # if facet-enable is true REQUIRED
facet-attribute-start=IGNORE

# End of range facets. Insert empty string for Categorical facets.
# # if facet-enable is true REQUIRED
facet-attribute-end=IGNORE

# Gap of range facets. Insert empty string for Categorical facets.
# # if facet-enable is true REQUIRED
facet-attribute-gap=IGNORE




# Attribute used as the boost value of a record
attribute-record-boost=relevance

#
# The following comments and parameters are related to ranking.  
#
# Intuitively, for a query and a candidate record (document), we compute the score of each query 
# term in the record, and take the summation of these scores as the overall
# score.  We order the records based on their overall score. The engine guarantees 
# that exact results are always ranked higher than fuzzy results.
#
# Formally, let Q be a query with terms (keywords) t_1, t_2, ..., t_k.  Let r be a record.
# We compute the score of r for Q as follows:
#
#    score(r, Q) = TermScore(r, t_1) + TermScore(r, t_k) + ... + TermScore(r, t_k).
#
# For each term t_i, let w_i be a keyword in r that matches t_i (exactly or fuzzily).
# The TermScore(r, t_i) is computed as follows:
#
#  TermScore(r, t_i) = RecordStaticScore(r, t_i) 
#                    * NormalizedEdSimilarity(w_i, t_i) 
#                    * PrefixMatchingNoramlizer
#
# where
#    NormalizedEdSimilarity(w_i, t_i) = 1 - EditDistance(w_i, t_i)/length(t_i).
#    The upper bound of EditDistance(w_i, t_i) is length(t_i).
#
#    PrefixMatchingNoramlizer: 
#         It is always 1 if term t_i is a complete keyword condition.
#         If term t_i is a prefix keyword condition, then PrefixMatchingNoramlizer takes
#         the value of the parameter "prefix-match-penalty" specified in this configuration file.
#
#    RecordStaticScore(r, t_i):
#         It is the static score of this term for this record, which is
#         computed and stored during index construction.  It uses
#         an expression customizable in this configuration file.  The expression 
#         can use the following parameters:
#            - idf_score: internal IDF score;
#            - doc_boost: the boost value of the record as specified in an attribute;
#            - doc_length: number of unique keywords in the record.
#
#         The expression allows operators such as +, -, /, *, (, ), 0-9, etc.
#
#         The "idf_score" uses the following formula:
#             idf_score(r, t_i) = sumOfFieldBoosts(r, t_i) * idf(t_i);
# 
#          "sumOfFieldBoosts(r, t_i)" is the summation of the boosts of the
#           attributes in which this keyword t_i appears in r.
#
#         "idf(t_i)" is the inversed document frequency:
#             idf(t_i) = log (total # of documents/ # of documents having term t_i).
#
#    In the case where the record r has multiple keywords w_i's that match term t_i,
#    TermScore(r, t_i) is the largest value among them.
#

#record-score-expression=doc_boost+(1/(doc_length+1))
record-score-expression=idf_score*doc_boost

# penalty for a prefix match.  This value is used to multiply the score of record for a term.
# default value = 0.95
prefix-match-penalty=0.95

# Boost values for searchable attributes.  A boost value is in the range [1,100].
# Specify the boost values as comma separated entries. For example, the boosts for four
# searchable attributes can be specified as 10,35,55,15.
# If the primary key is searchable, its default boost is the maximum boost. (TODO. What is the max boost?)
# OPTIONAL. The default value for each searchable attribute is 1. 
attribute-boosts=1

# TODO by Chen
# Default query term boost
# OPTIONAL. Defaults to 1
#default-query-term-boost=1

# Default query term similarity boost
# OPTIONAL. Defaults to 0.5
#default-query-term-similarity-boost=0.9

# Default query term similarity boost
# OPTIONAL. Defaults to 0.5
#default-query-term-length-boost=0.5

# Format of each json search response.
#  0: format "rid,edit_dist,matching_prefix,in_memory_record";
#  1: format "rid,edit_dist,matching_prefix".
# OPTIONAL. Its default value is 0.
search-response-format=0

# Default type of matching query terms
#  0: exact match
#  1: fuzzy match
# OPTIONAL. Its default value is 0.
default-query-term-match-type=0

# Default type for query terms.
#  0: a term is treated as a prefix;
#  1: a term is treated as a complete term;
# OPTIONAL. Its default value is 0.
default-query-term-type=0

# Number of results to retrieve
# OPTIONAL. Its default value is 10.
default-results-to-retrieve=10

######################### For incremental updates ########################
# The number of records after which newly inserted and deleted records
# are "merged" into the indexes.  Its minimum value is 10.
merge-every-n-seconds=10

# The number of write operations after which newly inserted and deleted records
# are "merged" into the indexes.
merge-every-m-writes=100

########################## HTTP server options ################################
# Hostname and port number of the server. Make sure the port is open. 
# REQUIRED
listening-hostname=127.0.0.1
listening-port=8081

# Number of bytes in the cache. It should be in the range [50MB, 500MB].
# OPTIONAL. Its default value is 50MB.
cache-size=104857600

# Maximum number of records that can be inserted into the engine.
doc-limit=15000000

##################### Do NOT change the following parameters ###########################

# 1 - File BootStrap True - Import data from json file at file path "file-path".
# 0 - File bootstrap False
# OPTIONAL. Its default value is 1
data-source-type=1

# Index type.
#  - 0: Text Index
#  - 1: Spatial+Text Index
# REQUIRED
index-type=0

# Attributes that can be used to sort the results.
# OPTIONAL
attributes-sort=IGNORE

# Data type of attributes used to sort results:
#  0: if unsigned;
#  1: if float.
# OPTIONAL
attributes-sort-type=IGNORE
attributes-sort-default-value=IGNORE

# REQUIRED if index-type=1
attribute-latitude=IGNORE
attribute-longitude=IGNORE

# 0 - Insert using HTTP API
# 1 - Insert using KAFKA
# OPTIONAL. Defaults to 0
write-api-type=0
